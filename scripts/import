#!/usr/bin/env bash

set -e

# create /tmp directory if it doesn't exist
mkdir -p ./tmp

# copy the database
cp "$HOME/Library/Group Containers/9K33E3U3T4.net.shinyfrog.bear/Application Data/database.sqlite" ./tmp/bear.sqlite

# query for posts and tags, convert JSON to markdown
sqlite3 ./tmp/bear.sqlite -cmd ".mode json" < ./scripts/import-from-bear/query-posts-tags.sql | ts-node ./scripts/import-from-bear

# clean up
rm ./tmp/bear.sqlite
